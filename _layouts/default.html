<!DOCTYPE html>
<html lang="{{ site.lang | default: 'en-US' }}" data-theme="">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    {% seo %}

    <!-- Set theme BEFORE paint to avoid flash -->
    <script>
      (function() {
        try {
          var stored = localStorage.getItem('theme');
          var prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
          var theme = stored || (prefersDark ? 'dark' : 'light');
          document.documentElement.setAttribute('data-theme', theme);
        } catch(e) {}
      })();
    </script>

    <!-- Minima core -->
    <link rel="stylesheet" href="{{ '/assets/css/style.css?v=' | append: site.github.build_revision | relative_url }}" />
    <!-- Your overrides (cache-busted) -->
    <link rel="stylesheet" href="{{ '/assets/css/custom.css' | relative_url }}?v={{ site.github.build_revision }}" />
  </head>
  <body>
    <header class="site-header" role="banner">
      <div class="wrapper" style="display:flex;align-items:center;gap:1rem;justify-content:space-between;">
        <a class="site-title" href="{{ '/' | relative_url }}">{{ site.title }}</a>
        <!-- Optional: simple theme toggle -->
        <button id="themeToggle" class="theme-btn" type="button" aria-label="Toggle theme">ðŸŒ“</button>
      </div>
    </header>

    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        {{ content }}
      </div>
    </main>

    <footer class="site-footer h-card">
      <div class="wrapper">
        <div style="text-align:center;width:100%">
          Â© {{ site.time | date: "%Y" }} Mason Colborn
        </div>
      </div>
    </footer>

    <script src="{{ '/assets/js/scale.fix.js' | relative_url }}"></script>
    <script>
      (function() {
        var btn = document.getElementById('themeToggle');
        function cur(){ return document.documentElement.getAttribute('data-theme') || 'light'; }
        function apply(t){ document.documentElement.setAttribute('data-theme', t); try{localStorage.setItem('theme', t);}catch(e){} }
        if (btn) btn.addEventListener('click', function(){ apply(cur()==='dark' ? 'light' : 'dark'); });
        try {
          var stored = localStorage.getItem('theme');
          if (!stored && window.matchMedia) {
            window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', e => apply(e.matches ? 'dark' : 'light'));
          }
        } catch(e) {}
      })();
    </script>
  </body>
</html>
